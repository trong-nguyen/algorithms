# Complete the function below.
from itertools import combinations

def check_relations(frenemy, possibilities, relation):
    for p in possibilities:
        res = [ frenemy[ p[i+1] ][ p[i] ] for i in xrange(len(p)-1) ]
        if ''.join(res) == relation:
            return True
    return False

def  isFrenemy(n, frenemy, x, y, relation):
    l = len(relation)
    if l == 0:
        return 0
    elif l == 1:
        return int( frenemy[x][y] == relation )
    else:
        m = l-2+1
        possible_indices = [ i for i in xrange(n) if i not in (x,y) ]
        possibilities = [ [x] + list(i) + [y] for i in list( combinations( possible_indices, m ) ) if i[0] != x and i[-1] != y ]
        if check_relations(frenemy, possibilities, relation):
            return 1
    return 0

test_cases = [
	{'input':[
		3,[
		'-FE',
		'F-F',
		'EF-',
		],0,
		2,
		'FF'
	],
	'output': 1
	},
	{'input':[
		100,
		'''-F--------------------------------------------------------------------------------------------------
		F-F-------------------------------------------------------------------------------------------------
		-F-F------------------------------------------------------------------------------------------------
		--F-F-----------------------------------------------------------------------------------------------
		---F-F----------------------------------------------------------------------------------------------
		----F-F---------------------------------------------------------------------------------------------
		-----F-F--------------------------------------------------------------------------------------------
		------F-F-------------------------------------------------------------------------------------------
		-------F-F------------------------------------------------------------------------------------------
		--------F-F-----------------------------------------------------------------------------------------
		---------F-F----------------------------------------------------------------------------------------
		----------F-F---------------------------------------------------------------------------------------
		-----------F-F--------------------------------------------------------------------------------------
		------------F-F-------------------------------------------------------------------------------------
		-------------F-F------------------------------------------------------------------------------------
		--------------F-F-----------------------------------------------------------------------------------
		---------------F-F----------------------------------------------------------------------------------
		----------------F-F---------------------------------------------------------------------------------
		-----------------F-F--------------------------------------------------------------------------------
		------------------F-F-------------------------------------------------------------------------------
		-------------------F-F------------------------------------------------------------------------------
		--------------------F-F-----------------------------------------------------------------------------
		---------------------F-F----------------------------------------------------------------------------
		----------------------F-F---------------------------------------------------------------------------
		-----------------------F-F--------------------------------------------------------------------------
		------------------------F-F-------------------------------------------------------------------------
		-------------------------F-F------------------------------------------------------------------------
		--------------------------F-F-----------------------------------------------------------------------
		---------------------------F-F----------------------------------------------------------------------
		----------------------------F-F---------------------------------------------------------------------
		-----------------------------F-F--------------------------------------------------------------------
		------------------------------F-F-------------------------------------------------------------------
		-------------------------------F-F------------------------------------------------------------------
		--------------------------------F-F-----------------------------------------------------------------
		---------------------------------F-F----------------------------------------------------------------
		----------------------------------F-F---------------------------------------------------------------
		-----------------------------------F-F--------------------------------------------------------------
		------------------------------------F-F-------------------------------------------------------------
		-------------------------------------F-F------------------------------------------------------------
		--------------------------------------F-F-----------------------------------------------------------
		---------------------------------------F-F----------------------------------------------------------
		----------------------------------------F-F---------------------------------------------------------
		-----------------------------------------F-F--------------------------------------------------------
		------------------------------------------F-F-------------------------------------------------------
		-------------------------------------------F-F------------------------------------------------------
		--------------------------------------------F-F-----------------------------------------------------
		---------------------------------------------F-F----------------------------------------------------
		----------------------------------------------F-F---------------------------------------------------
		-----------------------------------------------F-F--------------------------------------------------
		------------------------------------------------F-F-------------------------------------------------
		-------------------------------------------------F-F------------------------------------------------
		--------------------------------------------------F-F-----------------------------------------------
		---------------------------------------------------F-F----------------------------------------------
		----------------------------------------------------F-F---------------------------------------------
		-----------------------------------------------------F-F--------------------------------------------
		------------------------------------------------------F-F-------------------------------------------
		-------------------------------------------------------F-F------------------------------------------
		--------------------------------------------------------F-F-----------------------------------------
		---------------------------------------------------------F-F----------------------------------------
		----------------------------------------------------------F-F---------------------------------------
		-----------------------------------------------------------F-F--------------------------------------
		------------------------------------------------------------F-F-------------------------------------
		-------------------------------------------------------------F-F------------------------------------
		--------------------------------------------------------------F-F-----------------------------------
		---------------------------------------------------------------F-F----------------------------------
		----------------------------------------------------------------F-F---------------------------------
		-----------------------------------------------------------------F-F--------------------------------
		------------------------------------------------------------------F-F-------------------------------
		-------------------------------------------------------------------F-F------------------------------
		--------------------------------------------------------------------F-F-----------------------------
		---------------------------------------------------------------------F-F----------------------------
		----------------------------------------------------------------------F-F---------------------------
		-----------------------------------------------------------------------F-F--------------------------
		------------------------------------------------------------------------F-F-------------------------
		-------------------------------------------------------------------------F-F------------------------
		--------------------------------------------------------------------------F-F-----------------------
		---------------------------------------------------------------------------F-F----------------------
		----------------------------------------------------------------------------F-F---------------------
		-----------------------------------------------------------------------------F-F--------------------
		------------------------------------------------------------------------------F-F-------------------
		-------------------------------------------------------------------------------F-F------------------
		--------------------------------------------------------------------------------F-F-----------------
		---------------------------------------------------------------------------------F-F----------------
		----------------------------------------------------------------------------------F-F---------------
		-----------------------------------------------------------------------------------F-F--------------
		------------------------------------------------------------------------------------F-F-------------
		-------------------------------------------------------------------------------------F-F------------
		--------------------------------------------------------------------------------------F-F-----------
		---------------------------------------------------------------------------------------F-F----------
		----------------------------------------------------------------------------------------F-F---------
		-----------------------------------------------------------------------------------------F-F--------
		------------------------------------------------------------------------------------------F-F-------
		-------------------------------------------------------------------------------------------F-F------
		--------------------------------------------------------------------------------------------F-F-----
		---------------------------------------------------------------------------------------------F-F----
		----------------------------------------------------------------------------------------------F-F---
		-----------------------------------------------------------------------------------------------F-F--
		------------------------------------------------------------------------------------------------F-F-
		-------------------------------------------------------------------------------------------------F-F
		--------------------------------------------------------------------------------------------------F-'''.replace('\t', '').split('\n'),
		0,
		99,
		'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF',
	],
	'output': 0
	}
]

for i,case in enumerate( test_cases ):
	print case
	correctness = isFrenemy(*case['input'])
	print 'Test {} correctness'.format(i), correctness == case['output']
	if not correctness:
		print 'expected {}, output {}'.format(case['output'], correctness)


# f = open(os.environ['OUTPUT_PATH'], 'w')
    

# _n = int(raw_input());


# _frenemy_cnt = _n
# _frenemy_i=0
# _frenemy = []
# while _frenemy_i < _frenemy_cnt:
#     _frenemy_item = raw_input()
#     _frenemy.append(_frenemy_item)
#     _frenemy_i+=1

# _x = int(raw_input());


# _y = int(raw_input());


# _relation = raw_input()

# res = isFrenemy(_n, _frenemy, _x, _y, _relation);
# f.write(str(res) + "\n")

# f.close()


        
        

